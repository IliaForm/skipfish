(in /home/ilia/fish)
[Worker(host:ilia-UL30JT pid:2593)] Starting job worker
"testing"
1
[Worker(host:ilia-UL30JT pid:2593)] Site#skipfish_without_delay failed with ActiveRecord::StatementInvalid: Mysql2::Error: MySQL server has gone away: UPDATE `sites` SET `result` = '<html>\n<head>\n<!--\n\n   skipfish - report renderer\n   --------------------------\n\n   Author: Michal Zalewski <lcamtuf@google.com>\n\n   Copyright 2009, 2010 by Google Inc. All Rights Reserved.\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n     http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n\n-->\n<title>Skipfish - scan results browser</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n\n<style>\nbody {\n  font-family: \'Georgia\', \'Arial\', \'Helvetica\';\n  background-color: white;\n}\n\n.hdr_table {\n  float: right;\n  border: 1px dotted #C0C000;\n  background-color: #FFFFF0;\n  font-size: 80%;\n}\n\n.hdr_tips {\n  clear: right;\n  float: right;\n  font-size: 70%;\n  color: coral;\n  padding: 0.5em 0 0 0;\n}\n\n.summary1 {\n  padding: 0 1em 0 1em;\n}\n\n.summary2 {\n  color: teal;\n  padding: 0 1em 0 0;\n}  \n\nimg {\n  vertical-align: middle;\n  padding: 0 .5em 0 0;\n}\n\n.i2 {\n  vertical-align: middle;\n  padding: 0 0 0 .5em;\n}\n\n.i3 {\n  vertical-align: middle;\n  padding: 0 .2em 0 .2em;\n}\n\n.idupe {\n  opacity: 0.4;\n  filter: alpha(opacity=40);\n}\n\n.child_ctr, .child_ctr_exp {\n  padding: 0.2ex 0.5em 0.2ex 0.5em;\n  border: 1px solid white;\n  white-space: nowrap;\n}\n\ntd.child_ctr_exp:hover {\n  border: 1px solid #C0C0C0;\n  cursor: pointer;\n}\n\ntd.child_ctr:hover {\n}\n\n.name {\n  font-weight: bold;\n}\n\n.name_diff {\n  font-weight: bold;\n  color: white;\n  background-color: red;\n  padding: 0.2em 0.5em 0.2em 0.5em;\n}\n\nspan.sum_name {\n  font-weight: bold;\n  border: 1px solid white;\n}\n\nspan.sum_name:hover {\n  font-weight: bold;\n  cursor: pointer;\n  border: 1px solid #C0C0C0;\n}\n\n.dupe_name {\n  color: gray;\n}\n\n.fetch_info {\n  font-size: 70%;\n  color: gray;\n}\n\n.fetch_data {\n  color: teal;\n}\n\n.issue_desc {\n  font-weight: bold;\n}\n\n.issue_desc_diff {\n  font-weight: bold;\n  color: white;\n  background-color: blue;\n  padding: 0.2em 0.5em 0.2em 0.5em;\n}\n\n.comment {\n  color: crimson;\n  font-size:  70%;\n}\n\na { text-decoration: none; }\na:hover { text-decoration: underline; }\n\nh2 {\n  border-width: 0 0 1px 0;\n  border-style: solid;\n  border-color: crimson;\n}\n\nol {\n  margin: 0.5em 0 0 0;\n  padding: 0 0 0 1.5em;\n}\n\n.issue_ctr {\n  border-style: solid;\n  border-color: #FFF0E0;\n  border-width: 0px 0px 0px 10px;\n  padding: 0 0 0 0.5em;\n  margin: 0 0 0 0;\n}\n\n.node_ctr {\n  border-style: solid;\n  border-color: #E0FFFF;\n  border-width: 1px 0px 1px 10px;\n  padding: 0 0 0 0.5em;\n  margin: 0 0 0 0;\n}\n\n.issue_line {\n  border-width: 0 0 1px 0;\n  margin: 0.2em 0 0.2em 0;\n  border-style: dashed;\n  border-color: red;\n  width: 10em;\n}\n\n.s_cnt {\n  font-size: 80%;\n  color: teal;\n}\n\n.req_div {\n  position: absolute;\n  top: 0;\n  left: 0;\n  margin: 5% 0 0 10%;\n  width: 75%;\n  height: 80%;\n  border: 3px outset teal;\n  display: none;\n  background-color: white;\n  z-index: 10;\n  padding: 10px;\n}\n\n.req_hdr {\n  background-color: #FFFFE0;\n  border: 1px outset teal;\n  font-size: 70%;\n  text-align: center;\n  padding: 2px;\n  cursor: pointer;\n}\n\n.req_txtarea {\n  border: 1px inset teal;\n  padding: 2px;\n  margin: 1% 0px 0px 0px;\n  width: 100%;\n  height: 95%;\n}\n\ndiv.req_hdr:hover {\n  border: 1px inset teal;\n}\n\n.cover {\n  opacity: 0.7;\n  filter: alpha(opacity=70);\n  background-color: #F0F0F0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n  display: none;\n}\n\n.supp_cat {\n  color: #606060;\n}\n\n</style>\n\n<script src=\"summary.js\"></script>\n<script src=\"samples.js\"></script>\n\n<script>\n\nvar c_count      = 0;\nvar ignore_click = false;\nvar max_samples  = 100;\nvar diff_mode    = false;\n\n/* Descriptions for issues reported by the scanner. */\n\nvar issue_desc= {\n\n  \"10101\": \"SSL certificate issuer information\",\n  \"10201\": \"New HTTP cookie added\",\n  \"10202\": \"New \'Server\' header value seen\",\n  \"10203\": \"New \'Via\' header value seen\",\n  \"10204\": \"New \'X-*\' header value seen\",\n  \"10205\": \"New 404 signature seen\",\n  \"10401\": \"Resource not directly accessible\",\n  \"10402\": \"HTTP authentication required\",\n  \"10403\": \"Server error triggered\",\n  \"10501\": \"All external links\",\n  \"10502\": \"External URL redirector\",\n  \"10503\": \"All e-mail addresses\",\n  \"10504\": \"Links to unknown protocols\",\n  \"10505\": \"Unknown form field (can\'t autocomplete)\",\n  \"10601\": \"HTML form (not classified otherwise)\",\n  \"10602\": \"Password entry form - consider brute-force\",\n  \"10603\": \"File upload form\",\n  \"10701\": \"User-supplied link rendered on a page\",\n  \"10801\": \"Incorrect or missing MIME type (low risk)\",\n  \"10802\": \"Generic MIME used (low risk)\",\n  \"10803\": \"Incorrect or missing charset (low risk)\",\n  \"10804\": \"Conflicting MIME / charset info (low risk)\",\n  \"10901\": \"Numerical filename - consider enumerating\",\n  \"10902\": \"OGNL-like parameter behavior\",\n\n  \"20101\": \"Resource fetch failed\",\n  \"20102\": \"Limits exceeded, fetch suppressed\",\n  \"20201\": \"Directory behavior checks failed (no brute force)\",\n  \"20202\": \"Parent behavior checks failed (no brute force)\",\n  \"20203\": \"IPS filtering enabled\",\n  \"20204\": \"IPS filtering disabled again\",\n  \"20205\": \"Response varies randomly, skipping checks\",\n  \"20301\": \"Node should be a directory, detection error?\",\n\n  \"30101\": \"HTTP credentials seen in URLs\",\n  \"30201\": \"SSL certificate expired or not yet valid\",\n  \"30202\": \"Self-signed SSL certificate\",\n  \"30203\": \"SSL certificate host name mismatch\",\n  \"30204\": \"No SSL certificate data found\",\n  \"30301\": \"Directory listing restrictions bypassed\",\n  \"30401\": \"Redirection to attacker-supplied URLs\",\n  \"30402\": \"Attacker-supplied URLs in embedded content (lower risk)\",\n  \"30501\": \"External content embedded on a page (lower risk)\",\n  \"30502\": \"Mixed content embedded on a page (lower risk)\",\n  \"30601\": \"HTML form with no apparent XSRF protection\",\n  \"30602\": \"JSON response with no apparent XSSI protection\",\n  \"30701\": \"Incorrect caching directives (lower risk)\",\n\n  \"40101\": \"XSS vector in document body\",\n  \"40102\": \"XSS vector via arbitrary URLs\",\n  \"40103\": \"HTTP response header splitting\",\n  \"40104\": \"Attacker-supplied URLs in embedded content (higher risk)\",\n  \"40201\": \"External content embedded on a page (higher risk)\",\n  \"40202\": \"Mixed content embedded on a page (higher risk)\",\n  \"40301\": \"Incorrect or missing MIME type (higher risk)\",\n  \"40302\": \"Generic MIME type (higher risk)\",\n  \"40304\": \"Incorrect or missing charset (higher risk)\",\n  \"40305\": \"Conflicting MIME / charset info (higher risk)\",\n  \"40401\": \"Interesting file\",\n  \"40402\": \"Interesting server message\",\n  \"40501\": \"Directory traversal / file inclusion possible\",\n  \"40601\": \"Incorrect caching directives (higher risk)\",\n  \"40701\": \"Password form submits from or to non-HTTPS page\",\n\n  \"50101\": \"Server-side XML injection vector\",\n  \"50102\": \"Shell injection vector\",\n  \"50103\": \"Query injection vector\",\n  \"50104\": \"Format string vector\",\n  \"50105\": \"Integer overflow vector\",\n  \"50201\": \"SQL query or similar syntax in parameters\",\n  \"50301\": \"PUT request accepted\"\n\n};\n\n\n/* Simple HTML escaping routine. */\n\nfunction H(str) { return str.replace(/</g,\'&lt;\').replace(/\"/g,\'&quot;\'); }\n\n\n/* Simple truncation routine. */\n\nfunction TRUNC(str) { if (str.length > 70) return str.substr(0,69) + \"...\"; else return str; }\n\n\n/* Initializes scan information, loads top-level view. */\n\nfunction initialize() {\n  document.getElementById(\'sf_version\').innerHTML = sf_version;\n  document.getElementById(\'scan_date\').innerHTML = scan_date;\n  document.getElementById(\'scan_seed\').innerHTML = scan_seed;\n  document.getElementById(\'scan_time\').innerHTML =\n    Math.floor(scan_ms / 1000 / 60 / 60) + \" hr \" +\n    Math.floor((scan_ms / 1000 / 60)) % 60  + \" min \" +\n    Math.floor((scan_ms / 1000)) % 60  + \" sec \" +\n    (scan_ms % 1000) + \" ms\";\n\n  load_node(\'./\', \'root\');\n  load_mime_summaries();\n  load_issue_summaries();\n\n}\n\n\n/* Implements pretty, pointless fades. */\n\nfunction next_opacity(tid, new_val) {\n  var t = document.getElementById(tid);\n  t.style.opacity = new_val;\n  t.style.filter = \"alpha(opacity=\" + (new_val * 100) + \")\";\n  if (new_val < 1.0) \n    setTimeout(\'next_opacity(\"\' + tid + \'\", \' + (new_val + 0.1) + \')\', 50);\n}\n\n\n/* Loads or toggles visibility of a node. */\n\nfunction toggle_node(dir, tid) {\n  var t = document.getElementById(\'c_\' + tid);\n\n  if (ignore_click) { ignore_click = false; return; }\n\n  if (!t.loaded) {\n    load_node(dir, tid);\n    document.getElementById(\'exp_\' + tid).src = \'n_expanded.png\';\n    document.getElementById(\'exp_\' + tid).title = \'Click to collapse\';\n    t.loaded = true;\n    return;\n  }\n\n  if (t.style.display == \'none\') {\n    document.getElementById(\'exp_\' + tid).src = \'n_expanded.png\';\n    t.style.display = \'block\';\n    document.getElementById(\'exp_\' + tid).title = \'Click to collapse\';\n    next_opacity(\'c_\' + tid, 0);\n  } else {\n    document.getElementById(\'exp_\' + tid).src = \'n_collapsed.png\';\n    t.style.display = \'none\';\n    document.getElementById(\'exp_\' + tid).title = \'Click to expand\';\n  }\n\n}\n\n\n/* Displays request or response dump in a faux window. */\n\nfunction show_dat(path, ignore) {\n  var out = document.getElementById(\'req_txtarea\'),\n      cov = document.getElementById(\'cover\');\n\n  document.body.style.overflow = \'hidden\';\n\n  out.value = \'\';\n\n  var x = new XMLHttpRequest();\n  var content;\n\n  var pX = window.scrollX ? window.scrollX : document.body.scrollLeft;\n  var pY = window.scrollY ? window.scrollY : document.body.scrollTop;\n\n  out.parentNode.style.left = pX;\n  out.parentNode.style.top = pY;\n  cov.style.left = pX;\n  cov.style.top = pY;\n\n  out.parentNode.style.display = \'block\';\n  cov.style.display = \'block\';\n\n  x.open(\'GET\', path + \'/request.dat\', false);\n  x.send(null);\n\n  content = \'=== REQUEST ===\\n\\n\' + x.responseText;\n\n  x.open(\'GET\', path + \'/response.dat\', false);\n  x.send(null);\n\n  if (x.responseText.substr(0,5) == \'HTTP/\') \n    content += \'\\n=== RESPONSE ===\\n\\n\' + x.responseText + \'\\n=== END OF DATA ===\\n\';\n  else content += \'\\n=== RESPONSE NOT AVAILABLE ===\\n\\n=== END OF DATA ===\\n\';\n\n  out.value = content;\n  delete x;\n\n  out.focus();\n\n  if (ignore) ignore_click = true;\n  return false;\n}\n\n\n/* Displays request or response dump in a proper window. */\n\nfunction show_win(path, ignore) {\n  var out = window.open(\'\',\'_blank\',\'scroll=yes,addressbar=no\');\n  var x = new XMLHttpRequest();\n  var content;\n\n  x.open(\'GET\', path + \'/request.dat\', false);\n  x.send(null);\n\n  content = \'=== REQUEST ===\\n\\n\' + x.responseText;\n\n  x.open(\'GET\', path + \'/response.dat\', false);\n  x.send(null);\n\n  if (x.responseText.substr(0,5) == \'HTTP/\') \n    content += \'\\n=== RESPONSE ===\\n\\n\' + x.responseText + \'\\n=== END OF DATA ===\\n\';\n  else content += \'\\n=== RESPONSE NOT AVAILABLE ===\\n\\n=== END OF DATA ===\\n\';\n\n  out.document.body.innerHTML = \'<pre></pre>\';\n\n  out.document.body.firstChild.appendChild(out.document.createTextNode(content));\n  delete x;\n\n  if (ignore) ignore_click = true;\n  return false;\n}\n\n\n/* Hides request view. */\n\nfunction hide_dat() {\n\n  /* Work around a glitch in WebKit. */\n\n  if (navigator.userAgent.indexOf(\'WebKit\') == -1)\n    document.body.style.overflow = \'auto\';\n  else\n    document.body.style.overflow = \'scroll\';\n\n  document.getElementById(\'req_div\').style.display = \'none\';\n  document.getElementById(\'cover\').style.display = \'none\'\n}\n\n\n/* Loads issues, children for a node, renders HTML. */\n\nfunction load_node(dir, tid) {\n  var x = new XMLHttpRequest();\n  var t = document.getElementById(\'c_\' + tid);\n  var add_html = \'\';\n\n  x.open(\'GET\', dir + \'child_index.js\', false);\n  x.send(null);\n  eval(x.responseText);\n\n  x.open(\'GET\', dir + \'issue_index.js\', false);\n  x.send(null);\n  eval(x.responseText);\n\n  if (diff_mode) {\n    x.open(\'GET\', dir + \'diff_data.js\', false);\n    x.send(null);\n    eval(x.responseText);\n  }\n\n  delete x;\n\n  next_opacity(\'c_\' + tid, 0);\n\n  if (issue.length > 0)\n    add_html += \'<div class=issue_ctr>\\n\';\n\n  for (var cno = 0; cno < issue.length; cno++) {\n    var i = issue[cno];\n\n    add_html += \'<table><tr><td valign=\"top\">\\n\';\n\n    switch (i.severity) {\n      case 0:  add_html += \'<img src=\"i_note.png\" title=\"Informational note\">\'; break;\n      case 1:  add_html += \'<img src=\"i_warn.png\" title=\"Internal warning\">\'; break;\n      case 2:  add_html += \'<img src=\"i_low.png\" title=\"Low risk or low specificity\">\'; break;\n      case 3:  add_html += \'<img src=\"i_medium.png\" title=\"Medium risk - data compromise\">\'; break;\n      case 4:  add_html += \'<img src=\"i_high.png\" title=\"High risk: system compromise\">\'; break;\n    }\n\n    if (!diff_mode || diff_data[i.dir] == undefined) {\n      add_html += \'</td>\\n<td><div class=\"issue_desc\">\' + issue_desc[i.type] + \'</div>\\n<ol>\\n\';\n    } else {\n      add_html += \'</td>\\n<td><div class=\"issue_desc_diff\">\' + issue_desc[i.type] + \'</div>\\n<ol>\\n\';\n    }\n\n    for (var cno2 = cno; cno2 < issue.length; cno2++) {\n      var i2 = issue[cno2];\n\n      if (i2.type != i.type) break;\n\n      if (i2.fetched) {\n        add_html += \'<li><div class=\"fetch_info\">\' + \n                    \'Code: <span class=\"fetch_data\">\' + i2.code + \'</span>, \' +\n                    \'length: <span class=\"fetch_data\">\' + i2.len + \'</span>, \' +\n                    \'declared: <span class=\"fetch_data\">\' + H(i2.decl_mime) + \'</span>, \';\n        if (i2.sniff_mime != \'[none]\') add_html +=\n                    \'detected: <span class=\"fetch_data\">\' + H(i2.sniff_mime) + \'</span>, \';\n        add_html += \'charset: <span class=\"fetch_data\">\' + H(i2.cset) + \'</span> \' + \n                    \'[ <a href=\"#\" onclick=\"return show_dat(\\\'\' + dir + i2.dir + \'\\\', false)\">show trace</a> \' +\n                    \'<a href=\"#\" onclick=\"return show_win(\\\'\' + dir + i2.dir + \'\\\', false)\">+</a> ]</div>\\n\';\n      } else {\n        add_html += \'<li><div class=\"fetch_info\">\' + \n                    \'Fetch result: \' + i2.error + \'</div>\';\n      }\n  \n      if (i2.extra.length > 0) add_html += \'<div class=\"comment\">Memo: \' + H(i2.extra) + \'</div>\\n\';\n\n    }\n\n    cno = cno2 - 1;\n    add_html += \'</ol>\\n\';\n\n    add_html += \'</td></tr></table>\\n\';\n\n  }\n\n  if (issue.length > 0)\n    add_html += \'</div>\';\n\n  if (child.length > 0) \n    add_html += \'<div class=node_ctr>\';\n\n  for (var cno = 0; cno < child.length; cno++) {\n    var c = child[cno];\n    var has_child = false;\n    var cstr = \'\';\n\n    add_html += \'<table><tr><td valign=\"top\">\\n\';\n\n    if (c.dupe) cstr = \'class=\"idupe\" \';\n\n    switch (c.type) {\n      case 10: add_html += \'<img \' + cstr + \'src=\"p_serv.png\" title=\"Server node\">\'; break;\n      case 11: add_html += \'<img \' + cstr + \'src=\"p_dir.png\" title=\"Directory node\">\'; break;\n      case 12: add_html += \'<img \' + cstr + \'src=\"p_file.png\" title=\"File node\">\'; break;\n      case 13: add_html += \'<img \' + cstr + \'src=\"p_pinfo.png\" title=\"Script-like file\">\'; break;\n      case 100: add_html += \'<img \' + cstr + \'src=\"p_param.png\" title=\"GET or POST parameter\">\'; break;\n      case 101: add_html += \'<img \' + cstr + \'src=\"p_value.png\" title=\"Alternative parameter value\">\'; break;\n      default: add_html += \'<img \' + cstr + \'src=\"p_unknown.png\" title=\"Unknown node\">\';\n    }\n\n    if (c.child_cnt > 0 || c.issue_cnt[0] + c.issue_cnt[1] + c.issue_cnt[2] +\n        c.issue_cnt[3] + c.issue_cnt[4] > 0) {\n      add_html += \'</td>\\n<td class=\"child_ctr_exp\" onclick=\"toggle_node(\\\'\' +  \n                   dir + c.dir + \'/\\\', \' + c_count + \')\"\' + \'>\';\n      has_child = true;\n    } else {\n      add_html += \'</td>\\n<td class=\"child_ctr\">\'\n    }\n\n    if (has_child)\n      add_html += \'<img src=\"n_collapsed.png\" id=\"exp_\' + c_count + \'\"\' +\n                  \' title=\"Click to expand\">\\n\';\n\n    if (c.missing) {\n      if (c.linked == 2) \n        add_html += \'<img src=\"n_missing.png\" title=\"Resource missing\">\';\n      else\n        add_html += \'<img src=\"n_maybe_missing.png\" \' + \n                    \'title=\"Resource missing (guessed link)\">\';\n    }\n\n    if (!c.fetched) \n      add_html += \'<img src=\"n_failed.png\" title=\"Fetch failed\">\';\n\n    if (c.dupe) add_html += \'<img src=\"n_clone.png\" title=\"Suspected duplicate\">\' + \n      \'<span class=\"dupe_name\" title=\"\' + H(c.url) + \'\">\' + H(TRUNC(c.name)) + \'</span>\\n\';\n    else {\n      if (!diff_mode || diff_data[c.dir] == 0) {\n        add_html += \'<span class=\"name\" title=\"\' + H(c.url) + \'\">\' + H(TRUNC(c.name)) + \'</span>\\n\';\n      } else if (diff_data[c.dir] == 1) {\n        add_html += \'<span class=\"name_diff\" title=\"\' + H(c.url) + \'\">\' + H(TRUNC(c.name)) + \'</span>\\n\';\n      } else {\n        add_html += \'<span class=\"name_diff\" title=\"\' + H(c.url) + \'\">\' + H(TRUNC(c.name)) + \' (\' + diff_data[c.dir] + \' more)</span>\\n\';\n      }\n    }\n\n    if (c.linked == 0)\n      add_html += \'<img src=\"n_unlinked.png\" title=\"Not linked (brute-forced)\" class=\"i2\">\';\n\n    add_html += \'<span id=\"child_info\">\';\n\n    if (c.issue_cnt[4] > 0)\n      add_html += \'<img class=\"i2\" src=\"i_high.png\" title=\"High risk\">\' + c.issue_cnt[4];\n\n    if (c.issue_cnt[3] > 0)\n      add_html += \'<img class=\"i2\" src=\"i_medium.png\" title=\"Medium risk\">\' + c.issue_cnt[3];\n\n    if (c.issue_cnt[2] > 0)\n      add_html += \'<img class=\"i2\" src=\"i_low.png\" title=\"Low risk\">\' + c.issue_cnt[2];\n\n    if (c.issue_cnt[1] > 0)\n      add_html += \'<img class=\"i2\" src=\"i_warn.png\" title=\"Warnings\">\' + c.issue_cnt[1];\n\n    if (c.issue_cnt[0] > 0)\n      add_html += \'<img class=\"i2\" src=\"i_note.png\"  title=\"Notes\">\' + c.issue_cnt[0];\n\n    if (c.child_cnt > 0)\n      add_html += \'<img class=\"i2\" src=\"n_children.png\" title=\"Unique children nodes\">\' + c.child_cnt;\n\n    add_html += \'</span>\\n\';\n\n    if (c.fetched) {\n      add_html += \'<div class=\"fetch_info\">\' + \n                  \'Code: <span class=\"fetch_data\">\' + c.code + \'</span>, \' +\n                  \'length: <span class=\"fetch_data\">\' + c.len + \'</span>, \' +\n                  \'declared: <span class=\"fetch_data\">\' + H(c.decl_mime) + \'</span>, \';\n      if (c.sniff_mime != \'[none]\') add_html +=\n                  \'detected: <span class=\"fetch_data\">\' + H(c.sniff_mime) + \'</span>, \';\n\n      if (has_child)\n        add_html += \'charset: <span class=\"fetch_data\">\' + H(c.cset) + \'</span> \' + \n                    \'[ <a href=\"#\" onclick=\"return show_dat(\\\'\' + dir + c.dir + \'\\\', true)\">show trace</a> \' +\n                    \'<a href=\"#\" onclick=\"return show_win(\\\'\' + dir + c.dir + \'\\\', true)\">+</a> ]</div>\\n\';\n      else\n        add_html += \'charset: <span class=\"fetch_data\">\' + H(c.cset) + \'</span> \' + \n                    \'[ <a href=\"#\" onclick=\"return show_dat(\\\'\' + dir + c.dir + \'\\\', false)\">show trace</a> \' +\n                    \'<a href=\"#\" onclick=\"return show_win(\\\'\' + dir + c.dir + \'\\\', false)\">+</a> ]</div>\\n\';\n    } else {\n      add_html += \'<div class=\"fetch_info\">\' + \n                  \'Fetch result: \' + c.error + \'</div>\\n\';\n    }\n\n    if (has_child) add_html += \'</tr><tr>\\n<td></td>\\n<td id=\"c_\' + c_count + \'\">\';\n\n    add_html += \'</td></tr></table>\\n\';\n    c_count++;\n\n  }\n\n  if (child.length > 0) \n    add_html += \'</div>\';\n\n  t.innerHTML += add_html;\n\n}\n\n\n/* Picks the lesser of two evils. */\n\nfunction MIN(a,b) { if (a > b) return b; else return a; }\n\n\n/* Toggles visibility of a summary view. */\n\nfunction show_sum(t) {\n  var target = t.nextSibling.nextSibling.nextSibling.nextSibling;\n  if (target.style.display == \'block\') {\n    target.style.display = \'none\';\n  } else {\n    next_opacity(target.id, 0);\n    target.style.display = \'block\';\n  }\n}\n\n\n/* Loads MIME summaries. */\n\nfunction load_mime_summaries() {\n  var t = document.getElementById(\'doc_types\');\n\n  for (var cno = 0; cno < mime_samples.length; cno++) {\n    var m = mime_samples[cno], limit = MIN(max_samples, m.samples.length);\n    var add_html;\n\n    add_html = \'<table><tr><td valign=\"top\"><img src=\"mime_entry.png\"></td>\\n<td valign=\"top\">\';\n    add_html += \'<span class=\"sum_name\" onclick=\"show_sum(this)\">\' + H(m.mime) + \'</span>\\n<span class=\"s_cnt\">(\' + \n                m.samples.length + \')</span>\\n<ol id=\"sum_\' + (c_count++) + \'\" style=\"display: none\">\\n\';\n\n    for (var sno = 0; sno < limit; sno++) {\n\n      add_html += \'<li><a target=\"_blank\" href=\"\' + H(m.samples[sno].url) + \'\">\' + H(m.samples[sno].url) + \'</a> \';\n\n      if (m.samples[sno].linked == 0)\n        add_html += \'<img src=\"n_unlinked.png\" title=\"Not linked (brute-forced)\" class=\"i3\"> \';\n\n      add_html += \'<span class=\"s_cnt\">(\' + m.samples[sno].len + \' bytes)</span> <span class=\"fetch_info\">\' +\n                  \'[ <a href=\"#\" onclick=\"return show_dat(\\\'\' + m.samples[sno].dir + \'\\\', false)\">show trace</a> \' +\n                  \'<a href=\"#\" onclick=\"return show_win(\\\'\' + m.samples[sno].dir + \'\\\', false)\">+</a> ]</span>\\n\';\n\n    }\n\n    add_html += \'</ol></tr></td></table>\\n\';\n\n    t.innerHTML += add_html;\n\n  }\n\n}\n\n\n/* Loads issue summaries. */\n\nfunction load_issue_summaries() {\n  var t = document.getElementById(\'issue_types\');\n\n  for (var cno = 0; cno < issue_samples.length; cno++) {\n    var i = issue_samples[cno], limit = MIN(max_samples, i.samples.length);\n    var add_html;\n\n    add_html = \'<table><tr><td valign=\"top\">\';\n\n    switch (i.severity) {\n      case 0:  add_html += \'<img src=\"i_note.png\" title=\"Informational note\">\'; break;\n      case 1:  add_html += \'<img src=\"i_warn.png\" title=\"Internal warning\">\'; break;\n      case 2:  add_html += \'<img src=\"i_low.png\" title=\"Low risk or low specificity\">\'; break;\n      case 3:  add_html += \'<img src=\"i_medium.png\" title=\"Medium risk - data compromise\">\'; break;\n      case 4:  add_html += \'<img src=\"i_high.png\" title=\"High risk: system compromise\">\'; break;\n    }\n\n    add_html += \'</td>\\n<td valign=\"top\"><span class=\"sum_name\" onclick=\"show_sum(this)\">\' + \n      issue_desc[i.type] + \'</span>\\n<span class=\"s_cnt\">(\' + i.samples.length + \')</span>\\n\' +\n      \'<ol id=\"sum_\' + (c_count++) + \'\" style=\"display: none\">\\n\';\n\n    for (var sno = 0; sno < limit; sno++) {\n\n      add_html += \'<li> <a target=\"_blank\" href=\"\' + H(i.samples[sno].url) + \'\">\' + H(i.samples[sno].url) + \'</a> <span class=\"fetch_info\">\' +\n                  \'[ <a href=\"#\" onclick=\"return show_dat(\\\'\' + i.samples[sno].dir + \'\\\', false)\">show trace</a> \' +\n                  \'<a href=\"#\" onclick=\"return show_win(\\\'\' + i.samples[sno].dir + \'\\\', false)\">+</a> ]</span>\\n\';\n\n      if (i.samples[sno].extra && i.samples[sno].extra.length > 0) \n        add_html += \'<div class=\"comment\">Memo: \' + H(i.samples[sno].extra) + \'</div>\\n\';\n\n    }\n\n    add_html += \'</ol></tr></td></table>\\n\';\n\n    t.innerHTML += add_html;\n\n  }\n\n}\n\n\n/* Warns about CSS support issues. */\n\nif (\'\\v\' == \'v\')\n  alert(\'WARNING: This page works better with Firefox, Safari, Chrome, Opera, etc.\\n\\n\' +\n        \'Known problems in Internet Explorer include incorrectly rendered PNG icons, cursors,\\n\' +\n        \'HTML request dumps, incorrect CSS padding for many elements, and so forth. To my best\\n\' +\n        \'knowledge, these patterns trace back to problems with MSIE, not with this viewer.\');\n\n</script>\n\n</head>\n<body onload=\"initialize()\">\n\n<a href=\"http://code.google.com/p/skipfish/\" target=\"_blank\"><img src=\"sf_name.png\" width=\"205\" height=\"72\" style=\"float: left; border: 0\"></a>\n\n<div class=\"req_div\" id=\"req_div\">\n<div class=\"req_hdr\" id=\"req_hdr\" onclick=\"hide_dat()\">HTTP trace - click this bar or hit ESC to close</div>\n<textarea class=\"req_txtarea\" id=\"req_txtarea\" readonly onkeyup=\"if (event.keyCode == 27) hide_dat();\"></textarea>\n</div>\n<div id=\"cover\" class=\"cover\"></div>\n\n<table class=\"hdr_table\">\n<tr><td class=\"summary1\">Scanner version:</td><td class=\"summary2\" id=\"sf_version\"></td>\n<td class=\"summary1\">Scan date:</td><td class=\"summary2\" id=\"scan_date\"></td></tr>\n<tr><td class=\"summary1\">Random seed:</td><td class=\"summary2\" id=\"scan_seed\"></td>\n<td class=\"summary1\">Total time:</td><td class=\"summary2\" id=\"scan_time\"></td></tr>\n</table>\n\n<div class=\"hdr_tips\">\nProblems with this scan? \n<a href=\"http://code.google.com/p/skipfish/wiki/KnownIssues\" target=\"_blank\">Click here</a> for advice.\n</div>\n\n<br clear=\"all\">\n\n<h2>Crawl results - click to expand:</h2>\n<div id=\"c_root\" class=\"child_ctr\">\n</div>\n\n<h2 class=\"supp_cat\">Document type overview - click to expand:</h2>\n<div id=\"doc_types\">\n</div>\n\n<h2 class=\"supp_cat\">Issue type overview - click to expand:</h2>\n<div id=\"issue_types\">\n</div>\n<p>\n<span class=\"fetch_info\">NOTE: 100 samples maximum per issue or document type.</span>\n\n', `status` = 'tested', `updated_at` = '2011-05-06 04:47:26' WHERE `sites`.`id` = 1 - 0 failed attempts
